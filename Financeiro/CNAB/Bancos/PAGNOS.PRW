//// RETORNA O NOSSO NUMERO QUANDO COM VALOR NO E2_CODBAR, E ZEROS QUANDO NAO
//// TEM VALOR POSICAO ( 142 - 150 )

user function pagnos(_RETNOS)

If SUBSTR(SE2->E2_CODBAR,1,3) == "237"

    _RETNOS := SUBS(SE2->E2_CODBAR,28,9)

ElseIf SubStr(SE2->E2_LINDIG,1,3) == "237"
    _RETNOS := SUBS(SE2->E2_LINDIG,14,7)
    _RETNOS += SUBS(SE2->E2_LINDIG,22,2)
Else

    _RETNOS := "000000000"

EndIf

Return(_RETNOS)
